<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试移动云资源库</title>
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/resource-library.css">
    <style>
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            background: white;
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 15px;
            font-size: 12px;
            z-index: 10000;
            max-height: 400px;
            overflow-y: auto;
        }
        .debug-panel h4 {
            margin: 0 0 10px 0;
            color: #007bff;
        }
        .debug-log {
            background: #f8f9fa;
            padding: 5px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <!-- 调试面板 -->
    <div class="debug-panel">
        <h4>🔧 调试信息</h4>
        <div id="debugLogs"></div>
        <button onclick="clearLogs()" style="margin-top: 10px;">清除日志</button>
    </div>

    <div class="container">
        <!-- 顶部导航栏 -->
        <header class="header">
            <div class="header-content">
                <button class="back-btn" onclick="history.back()">
                    <span class="back-arrow">‹</span>
                </button>
                <h1>移动云资源库 (调试版)</h1>
                <button class="search-btn">
                    <span class="search-symbol">🔍</span>
                </button>
            </div>
        </header>

        <!-- 搜索栏 -->
        <div class="search-section" id="searchSection">
            <div class="search-box">
                <input type="text" placeholder="输入关键词进行语义搜索..." class="search-input" id="searchInput">
                <button class="search-submit-btn" onclick="performSearch()">搜索</button>
            </div>
        </div>

        <!-- 分类导航 -->
        <div class="category-nav">
            <div class="tab-scroll">
                <div class="tab-item active" data-category="all">全部</div>
                <div class="tab-item" data-category="manual">产品手册</div>
                <div class="tab-item" data-category="solution">解决方案</div>
                <div class="tab-item" data-category="training">培训资料</div>
                <div class="tab-item" data-category="case">客户案例</div>
            </div>
        </div>

        <!-- 热门推荐 -->
        <div class="hot-section">
            <h3>🔥 热门推荐</h3>
            <div class="hot-list">
                <!-- 热门推荐内容将通过JavaScript动态加载 -->
            </div>
        </div>

        <!-- 文档列表 -->
        <div class="document-list">
            <div class="list-header">
                <h3>文档资源</h3>
            </div>
            <div class="document-items">
                <!-- 文档列表内容将通过JavaScript动态加载 -->
            </div>
        </div>
    </div>

    <script src="scripts/common.js"></script>
    <script>
        // 调试日志函数
        function debugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logDiv = document.createElement('div');
            logDiv.className = `debug-log ${type}`;
            logDiv.innerHTML = `[${timestamp}] ${message}`;
            
            const logsContainer = document.getElementById('debugLogs');
            logsContainer.appendChild(logDiv);
            logsContainer.scrollTop = logsContainer.scrollHeight;
            
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function clearLogs() {
            document.getElementById('debugLogs').innerHTML = '';
        }

        // 检查依赖
        debugLog('开始检查依赖...');
        
        if (typeof window.commonUtils !== 'undefined') {
            debugLog('✅ commonUtils 已加载', 'success');
        } else {
            debugLog('❌ commonUtils 未加载', 'error');
        }

        // 页面加载完成后的检查
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('DOM 加载完成');
            
            // 检查关键元素
            const hotList = document.querySelector('.hot-list');
            const documentItems = document.querySelector('.document-items');
            
            if (hotList) {
                debugLog('✅ 热门推荐容器找到', 'success');
            } else {
                debugLog('❌ 热门推荐容器未找到', 'error');
            }
            
            if (documentItems) {
                debugLog('✅ 文档列表容器找到', 'success');
            } else {
                debugLog('❌ 文档列表容器未找到', 'error');
            }
            
            // 延迟检查内容是否加载
            setTimeout(() => {
                const hotItems = document.querySelectorAll('.hot-item');
                const docItems = document.querySelectorAll('.doc-item');
                
                debugLog(`热门推荐项目数量: ${hotItems.length}`);
                debugLog(`文档列表项目数量: ${docItems.length}`);
                
                if (hotItems.length === 0 && docItems.length === 0) {
                    debugLog('⚠️ 没有内容被加载，可能存在JavaScript错误', 'warning');
                }
            }, 3000);
        });
    </script>
    <script src="scripts/resource-library.js"></script>
    <script>
        // 在resource-library.js加载后进行检查
        setTimeout(() => {
            debugLog('检查resource-library.js中的函数...');
            
            if (typeof loadResourceData === 'function') {
                debugLog('✅ loadResourceData 函数存在', 'success');
            } else {
                debugLog('❌ loadResourceData 函数不存在', 'error');
            }
            
            if (typeof REAL_FILES_DATA !== 'undefined') {
                debugLog(`✅ REAL_FILES_DATA 存在，包含 ${REAL_FILES_DATA.length} 个文件`, 'success');
            } else {
                debugLog('❌ REAL_FILES_DATA 不存在', 'error');
            }
            
            if (typeof updateHotRecommendations === 'function') {
                debugLog('✅ updateHotRecommendations 函数存在', 'success');
            } else {
                debugLog('❌ updateHotRecommendations 函数不存在', 'error');
            }
        }, 1000);
    </script>
</body>
</html>
