<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€ç»ˆæµ‹è¯•ï¼šæœç´¢"è¡Œä¸š"çƒ­é—¨æ¨è</title>
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/resource-library.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-results {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .search-section {
            display: block !important;
            margin-bottom: 20px;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>æœ€ç»ˆæµ‹è¯•ï¼šæœç´¢"è¡Œä¸š"çƒ­é—¨æ¨èåŠŸèƒ½</h1>
        
        <div class="test-section">
            <h2>éœ€æ±‚è¯´æ˜</h2>
            <p>å½“ç”¨æˆ·åœ¨èµ„æºåº“é¡µé¢æœç´¢å…³é”®è¯"è¡Œä¸š"æ—¶ï¼Œçƒ­é—¨æ¨èåº”è¯¥åªæ˜¾ç¤º"å…šæ”¿è¡Œä¸šé‡ç‚¹è§£å†³æ–¹æ¡ˆåŠæ¡ˆä¾‹"è¿™ä¸ªæ–‡æ¡£ã€‚</p>
        </div>

        <div class="test-section">
            <h2>æœç´¢åŠŸèƒ½</h2>
            <div class="search-section active">
                <div class="search-box">
                    <input type="text" placeholder="è¾“å…¥å…³é”®è¯è¿›è¡Œæœç´¢..." class="search-input" id="searchInput" value="è¡Œä¸š">
                    <button class="search-submit-btn" onclick="performSearch()">æœç´¢</button>
                </div>
            </div>
            
            <div class="test-buttons">
                <button class="test-button" onclick="testSearchIndustry()">æµ‹è¯•æœç´¢"è¡Œä¸š"</button>
                <button class="test-button" onclick="testSearchEducation()">æµ‹è¯•æœç´¢"æ•™è‚²"</button>
                <button class="test-button" onclick="testSearchCloud()">æµ‹è¯•æœç´¢"ç§»åŠ¨äº‘"</button>
                <button class="test-button" onclick="clearSearch()">æ¸…ç©ºæœç´¢</button>
            </div>
        </div>

        <div class="test-section">
            <h2>çƒ­é—¨æ¨èåŒºåŸŸ</h2>
            <div class="hot-section">
                <h3>ğŸ”¥ çƒ­é—¨æ¨è</h3>
                <div class="hot-list" id="hotList">
                    <!-- çƒ­é—¨æ¨èå†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>æ–‡æ¡£åˆ—è¡¨åŒºåŸŸ</h2>
            <div class="document-list">
                <div class="document-items" id="documentItems">
                    <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>æµ‹è¯•ç»“æœ</h2>
            <div class="test-results" id="testResults">
                ç­‰å¾…æµ‹è¯•...
            </div>
        </div>
    </div>

    <script src="scripts/common.js"></script>
    <script src="scripts/resource-library.js"></script>
    <script>
        let testResults = [];

        function logResult(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸';
            const result = `[${timestamp}] ${prefix} ${message}`;
            testResults.push(result);
            updateTestResults();
            console.log(result);
        }

        function updateTestResults() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = testResults.join('\n');
        }

        function checkHotRecommendations(expectedTitle = null) {
            setTimeout(() => {
                const hotItems = document.querySelectorAll('.hot-item');
                const hotTitles = Array.from(hotItems).map(item => 
                    item.querySelector('h4')?.textContent || 'æœªçŸ¥æ ‡é¢˜'
                );
                
                logResult(`å½“å‰çƒ­é—¨æ¨èæ•°é‡: ${hotItems.length}`);
                if (hotTitles.length > 0) {
                    hotTitles.forEach((title, index) => {
                        logResult(`  ${index + 1}. ${title}`);
                    });
                    
                    if (expectedTitle) {
                        if (hotTitles.length === 1 && hotTitles[0] === expectedTitle) {
                            logResult(`éœ€æ±‚éªŒè¯é€šè¿‡ï¼šçƒ­é—¨æ¨èåªæ˜¾ç¤º"${expectedTitle}"`, 'success');
                        } else {
                            logResult(`éœ€æ±‚éªŒè¯å¤±è´¥ï¼šæœŸæœ›åªæ˜¾ç¤º"${expectedTitle}"ï¼Œå®é™…æ˜¾ç¤º${hotTitles.length}ä¸ªé¡¹ç›®`, 'error');
                        }
                    }
                } else {
                    logResult('çƒ­é—¨æ¨èåŒºåŸŸä¸ºç©º');
                }
            }, 1000);
        }

        function checkSearchResults() {
            setTimeout(() => {
                const docItems = document.querySelectorAll('.doc-item');
                const docTitles = Array.from(docItems).map(item => 
                    item.querySelector('h4')?.textContent || 'æœªçŸ¥æ ‡é¢˜'
                );
                
                logResult(`æœç´¢ç»“æœæ•°é‡: ${docItems.length}`);
                if (docTitles.length > 0) {
                    docTitles.forEach((title, index) => {
                        logResult(`  ${index + 1}. ${title}`);
                    });
                }
            }, 1000);
        }

        function testSearchIndustry() {
            logResult('å¼€å§‹æµ‹è¯•æœç´¢"è¡Œä¸š"å…³é”®è¯');
            const searchInput = document.getElementById('searchInput');
            searchInput.value = 'è¡Œä¸š';
            performSearch();
            checkSearchResults();
            checkHotRecommendations('å…šæ”¿è¡Œä¸šé‡ç‚¹è§£å†³æ–¹æ¡ˆåŠæ¡ˆä¾‹');
        }

        function testSearchEducation() {
            logResult('å¼€å§‹æµ‹è¯•æœç´¢"æ•™è‚²"å…³é”®è¯');
            const searchInput = document.getElementById('searchInput');
            searchInput.value = 'æ•™è‚²';
            performSearch();
            checkSearchResults();
            checkHotRecommendations();
        }

        function testSearchCloud() {
            logResult('å¼€å§‹æµ‹è¯•æœç´¢"ç§»åŠ¨äº‘"å…³é”®è¯');
            const searchInput = document.getElementById('searchInput');
            searchInput.value = 'ç§»åŠ¨äº‘';
            performSearch();
            checkSearchResults();
            checkHotRecommendations();
        }

        function clearSearch() {
            logResult('æ¸…ç©ºæœç´¢ï¼Œæ¢å¤åˆå§‹çŠ¶æ€');
            const searchInput = document.getElementById('searchInput');
            searchInput.value = '';
            if (typeof loadRealFilesData === 'function') {
                loadRealFilesData();
            }
            checkHotRecommendations();
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            logResult('é¡µé¢åˆå§‹åŒ–å¼€å§‹');
            
            // æ£€æŸ¥æ•°æ®æ˜¯å¦åŠ è½½
            if (typeof window.REAL_FILES_DATA !== 'undefined') {
                logResult(`REAL_FILES_DATA å·²åŠ è½½ï¼ŒåŒ…å« ${window.REAL_FILES_DATA.length} ä¸ªæ–‡ä»¶`);
            } else {
                logResult('é”™è¯¯ï¼šREAL_FILES_DATA æœªå®šä¹‰', 'error');
            }
            
            // æ£€æŸ¥å…³é”®å‡½æ•°æ˜¯å¦å­˜åœ¨
            const requiredFunctions = ['performSearch', 'updateHotRecommendationsWithFilter', 'loadRealFilesData'];
            requiredFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    logResult(`å‡½æ•° ${funcName} å·²å®šä¹‰`, 'success');
                } else {
                    logResult(`è­¦å‘Šï¼šå‡½æ•° ${funcName} æœªå®šä¹‰`, 'error');
                }
            });
            
            logResult('é¡µé¢åˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
            
            // è‡ªåŠ¨æ‰§è¡Œæœç´¢"è¡Œä¸š"çš„æµ‹è¯•
            setTimeout(() => {
                testSearchIndustry();
            }, 1000);
        });
    </script>
</body>
</html>
